# 3G3 Introduction to Neuroscience[^1]
[^1]:Created by: Tom Xiaoding  Lu on 24/02/19
## 1. Synaptic Transmission
* Two basic forms of synaptic transmission: electrical or chemical
![1](/assets/1_odpkmolv6.PNG)
### 1.1 **Electrical synapses** are employed primarily to send rapid and stereotyped depolarizing signals.
  - Pre and postsynaptic cells communicate through special channels the **gap-junction channels (4nm)** which directly connects the cytoplasm of two cells
  - These gap-junction channels contain specialized protein structures that conduct ionic current from the presynaptic to postsynaptic cell.
  ![2](/assets/2_ombld4lvr.PNG)
  - **Neurotransmitters** released from nearby chemical synapses can modulate the opening of gap-junction channels through **intracellular metabolic reactions**
  - At electrical synapses some of the current from excitatory synaptic transmission will enter the postsynaptic cell through the gap-junction channels
  - To generate large enough current to not only depolarize the presynaptic cell above the threshold **but also generate sufficient ionic current to produce a change in potential in the postsynaptic cell**, the presynaptic terminal must be big enough for its membrane to contain many ion channels.
  - At the same time, the postsynaptic cell must be **relatively small**. This is because a small cell has a **higher input resistance**, hence it undergoes a **greater voltage change** ($\Delta V = IR_{in}$)
  - The time between the presynaptic spike and the postsynaptic potential is **virtually instantaneous**, such a short latency is not possible with chemical transmission, which requires several biochemical steps.
  - **The change in potential of the postsynaptic cell is directly related to the size and shape of the change in potential of the presynaptic cell**. Even a weak subthreshold depolarizing current injected into the presynaptic neuron, some current enters the postsynaptic neuron and depolarizes it. (By contrast, at chemical synapse this does not happen, presynaptic current must reach threshold)
  - **Electrical transmission allows the rapid and synchronous firing of interconnected cells**
    - Speed is important or escape responses
    - Useful for orchestrating the actions of large group of neurons, several small cells can act coordinately as one large cell
    - Because of **electrical coupling** between cells, the **effective resistance** of the coupled network of neurons is **smaller** than the resistance of an individual cell. Thus **the synaptic current required to fire electrically coupled cells is larger than that necessary to fire an individual cell**. Hence **electrically coupled cells have a higher firing threshold**, once this threshold is reached, they fire synchronously.
  - **Electrical synapses can also transmit metabolic signals between cells**
    - **Because gap-junction channels are relatively large and nonselective**, they conduct a variety of inorganic cations and anions.
    - Including the second messenger Ca$^{2+}$ and cAMP to pass from one cell to the next.

### 1.2 **Chemical synapses** are capable of more variable signaling and thus can produce more complex behaviors.
  - Can mediate either excitatory or inhibitory actions in postsynaptic cells
  - Can produce electrical changes in the postsynaptic cell that last from milliseconds to many minutes
  - Serve to amplify neuronal signals
  - **No direct low-resistance pathway** between pre- and postsynaptic cells.
  - Action potential in presynaptic neuron initiates the release of a **chemical transmitter** which diffuses across the **synaptic cleft** to interact with receptors on the **membrane** of the postsynaptic cells.
    - A **neurotransmitter** is a chemical substance that binds receptors in the postsynaptic membrane of the target cell
  - **Exocytosis**:
    - During a presynaptic action potential, voltage-gated Ca$^{2+}$ channels at the activation zone open
    - Ca$^{2+}$ ions enter the presynaptic terminal, the rise in intracellular concentration triggers a biochemical reaction
    - This reaction causes the vesicles to fuse with the presynaptic membrane and release neurotransmitter into the synaptic cleft
  - The transmitter molecules then diffuse across the synaptic cleft and bind to their receptors on the postsynaptic cell membrane
    - Which in turn activates the receptors
    - Leading to the opening or closing of ion channels
    - Resulting flux of ions alters the membrane conductance and potential of postsynaptic cell.
  ![4](/assets/4_ahl9pq70g.PNG)
 - These steps cause a delay that can be from 0.3ms to several milliseconds. Although chemical transmission lacks the speed of electrical synapses, it has the property of **amplification**
   - Just one synaptic vesicle releases several thousand molecules of transmitter
   - These transmitters can together open thousands of ion channels in the target cell
   - Small presynaptic nerve terminal, which generates only a weak electrical current can depolarize a large postsynaptic cell.
 - All receptors for chemical transmitters have two biochemical features in common:
   - They are **membrane spanning proteins**, the region exposed to the external environment of the cell recongnizes and binds the transmitter from the presynaptic cell.
   - They carry out an effector function within the target cell, the receptors **typically influence the opening or closing of ion channels**
### 1.3 Different Types of Postsynaptic Receptors
Neurotransmitters control the opening of ion channels in the postsynaptic cell either directly or indirectly.
- **Ionotropic and metabotropic receptors**
  - Receptors that gate ion channels directly such as the **ACh (Acetylcholine) receptor** at the neuromuscular junction
  - Composed of four or five subunits that form a single macromolecule
  - Contain both an extracellular domain that forms the binding site for the transmitter and a membrane-spanning domain that forms an ion conducting pore
  - Upon binding neurotransmitter, the receptor **undergoes a conformational change that opens the channel**
  - Produce relatively fast synaptic actions lasting only milliseconds, commonly found at synapses in neural circuits that mediate rapid behaviors
  - **Ionotropic glutamate receptors** have been divided into four subtypes on the basis of their ligand binding properties and sequence similarity: **AMPA, kainate, NMDA and delta** receptors (AMPA, NMDA discussed later.)
- **AMPA and NMDA receptors**
   ![Capture](/assets/Capture_kx2dz90xs.PNG)
  - Both ionotropic receptors activated by glutamate, found together in the neural membrane
  - Both receptors when open allow sodium and potassium ions to move through  
  - Weak stimulation only activates the AMPA receptors, resulting in a **slight** depolarization of the post-synaptic neuron
  - The pore of the NMDA receptor is blocked by a magnesium ion under low stimulus strength, thus the EPSP is mediated by AMPA mostly
  - Given stimulus of sufficient strength and frequency, the magnesium ion blocking NMDA receptor is removed, NMDA opens allowing **not only sodium and potassium ions through, but also calcium ions**
  - The calcium ion acts as a second messenger allowing for signaling cascades
    - Some calcium binds to calmodulin
    - Calmodulin binds to protein kinases such as CaMKII (Cam kinase)
    - CaMKII phosphorylates existing AMPA receptors, increasing its conductivity
    - CaMKII also promotes movement of AMPA receptors from intracellular stores onto the membrane
  - Calcium may also **facilitate the release of transmitters** from the axon terminal via retrograde signal
  - In any case, the connection strength at the synapse is **enhanced**, which may lead to LTP
* **Metabotropic receptors**
  - Receptors that gate ion channels indirectly, like the several types of receptors for **dopamine** and **norepinephrine** in neurons of the cerebral cortex
  - Normally composed of one or at most two subunits that are distinct from the ion channels they regulate
  - **Activation of these receptors often stimulates the production of second messengers** such as cAMP and diacyglycerol
  - Many of the second messengers active **protein kinases**, enzymes that phosphorylate different substrate proteins
  - In many cases the protein kinases directly phosphorylate ion channels, leading to their opening and closing
  - Produce slower synaptic actions lasting seconds to minutes, can modulate behavior by altering the excitability of neurons and the strength of the synaptic connections
  - Often act as crucial reinforcing pathways in the process of learning.
  - In the picture below, we see that the receptors are composed of a single subunit which activate a **guanosine triphosphate (GTP)-binding protein (G protein)** which in turn stimulates **adenylyl cyclase** which converts ATP to cAMP, the cAMP activates the cAMP dependent protein kinase (PKA) which phosphorylates the channel, leading to a change in function.
![5](/assets/5_keou6b44w.PNG)

### 1.3 Cellular Mechanisms of Implicit Memory Storage
There are two major forms of memory, **implicit** and **explicit** memory:
- Implicit memory (Left picture):
  - Operates unconsciously and automatically
  - For habits and perceptual and motor skills
  - Long term storage requires a family of structures:
    - **neocortex** for priming
    - **Striatum** for skills and habits
    - **Amygdala** for learned fear
    - **Cerebellum** for learned motor skills
    - Certain reflex pathways for non-associative learning such as habituation and sensitization
- Explicit memory (Right picture):
  - Operates consciously
  - Memory for people, places and objects
  - Long term storage of explicit memory begins in the **hippocampus** and the **medial temporal lobe** of the **neocortex**
![6](/assets/6_s2r7ljuu4.PNG)

**Implicit Memory Storage Involves Changes In the Effectiveness of Synaptic Transmission**, in this section, we discuss **habituation, sensitization and classical conditioning** mechanisms. Using *Aplysia* which has a repertory of defensive reflexes for withdrawing its respiratory gill and siphon, a small fleshy spout above the gill used to expel seawater.
- **Habituation results from an Activity-Dependent Presynaptic Depression of Synaptic Transmission**
  - Touching the siphon excites a population of mechanoreceptor sensory neurons that innervate the siphon
  - The release of **glutamate** from sensory neuron terminals generates fast **excitatory postsynaptic potentials** (EPSPs) in the interneurons and motor cells
  ![11](/assets/11_73svbx843.PNG)
  - EPSPs from sensory and interneurons summate on motor cells both temporally and spatially
  - The motor cells discharge strongly, thereby producing withdrawal of the gill
  - If stimulus is repeated. **EPSPs produced by sensory neurons in both interneurons and motor cells progressively decrease** paralleling the habituation of gill withdrawal.
  - In addition, repeated stimulation also leads to a decrease in the strength of synaptic transmission from the excitatory interneurons to the motor neurons.
  - This is due to **the amount of glutamate released from presynaptic terminals of sensory neurons decreases**
  - **Fewer synaptic vesicles are released with each action potential in the sensory neuron.**
  - This reduction is referred as **homosynaptic depression**. As the sensitivity of the postsynaptic glutamate receptors does not change because the reduction in transmission occurs in the **active pathway** itself and does not require another modulatory cell.
  - In *Aplysia* a single session of 10 stimuli leads to a short-term habituation lasting few minutes, four sessions separated by resting periods produce long-term habituation lasting around 3 weeks.
  - Long term habituation is caused by **a decrease in the number of synaptic contacts between sensory and motor neurons**
![7](/assets/7_zi8g27d94.PNG)

- **Sensitization Involves Presynaptic Facilitation of Synaptic Transmission**
  ![8](/assets/8_dny4l6d66.PNG)
  - With a harmful stimulus the animal typically learns fear, it responds vigorously not only to the harmful stimulus but also to other concurrent stimuli.
  - Tail shock of the *Aplysia* is sufficient to overcome the effects of habituation and enhance a habituated gill-withdraw reflex in a process termed **dishabituation**
  - In *Aplysia*, sensitization is achieved via a **heterosynaptic process** thad depends on modulatory interneurons activated by the harmful stimulus to the tail
  ![10](/assets/10_2y37israj.PNG)
  - The **serotonergic interneurons** use **serotonin** as a transmitter, form synapses on many regions of the sensory neurons, including **axo-axonic synapses**(synapses that intervene between axons) on the presynaptic terminals on the sensory cells.
  - The serotonin released from the interneurons after a single tail shock binds to a 5-HT receptor in the sensory neurons that is coupled to a **stimulatory G protein** that increases the **activity of adenylyl cyclase**
  - This action produces the **second messenger cAMP** which in turn activates the **cAMP-dependent kinase (PKA)**
  - Serotinin also activates a second type of G protein-coupled receptor that leads to the **hydrolysis of phospholipids and the activation of protein kinase C (PKC)**
  - The protein phosphorylation mediated by PKA and PKC **enhances** the release of transmitter from transmitter from sensory neurons in two mechanisms:
    - **PKA phosphorylates a K$^{+}$ channel**, causing it to close, which broadens the action potential and thus enhances Ca$^{2+}$ influx through voltage-gated Ca$^{2+}$ channels which in turn enhances transmitter release
    - **PKC enhances the functioning of the release machinery directly**
    ![91](/assets/91.PNG)
  - **Classical Conditioning**
  Classical conditioning of fear involves coordinated pre and postsynaptic facilitation of synaptic transmission
    - An initial weak conditioned stimulus becomes highly effective in producing a response when paired with a strong unconditioned stimulus
    - In *Aplysia*, a weak touch to the siphon serves as the conditioned stimulus while a strong shock to the tail serves as the unconditioned stimulus
    - **Activity dependent facilitation** is the process where the serotonin from the interneurons produces even greater presynaptic facilitation when the tail shock immediately follows a slight tap on the siphon.
    - The siphon is touched immediately prior to shocking the tail, as a result, the siphon sensory neurons **are primed to be more responsive to input from the faciliatory interneurons** in the unconditioned pathway  
    - The action potential triggers an **influx of Ca$^{2+}$** into the sensory neuron's presynaptic terminals
    - The Ca$^{2+}$ binds to **calmodulin** and the complex in turn binds to **adenylyl cyclase**.
    - This **primes the adenylyl cyclase** so that it responds more vigorously to the **serotonin released following the US at the tail**
    - As a result, the production of cAMP is enhanced, which increases the amount of presynaptic facilitation.
    ![12](/assets/12.PNG)
    - **Siphon touched --> Lots Ca$^{2+}$ in presynaptic site --> These Ca$^{2+}$ binds with calmodulin forming a complex --> The complex binds to adenylyl cyclase (priming) --> Responds more vigorously to the serotonin released following UC --> Increases order of presynaptic facilitation**
    - Classical conditioning in this sense is largely an elaboration of sensitization mechanism, with the added feature that the adenylyl cyclase serves as a **coincidence detector**
    - From the perspective of motor neuron (postsynaptic synapse), **classic conditioning causes a larger influx of Na$^{+}$ ions** into the postsynaptic synapse
    - Therefore increased AMPA activity activates NMDA receptors allowing more Ca$^{2+}$ ions into the synapse causing several intracellular intercellular cascades
    - Ca$^{2+}$ binds with calmodulin forming complex which activates CAMKinase (CaMKII).
    - CamKinase phosphorylate AMPA receptors increasing their conductance to sodium ions
    - CamKinase also promotes AMPA receptors from intracellular stores into the membrane making new AMPA receptors
    - Calcium ions may also facilitate the release of transmitter from the presynaptic terminal via **retrograde signal generator** such as NO and CO
    - As a result, the response to a stimulus of a given strength will be stronger than before the NMDA is activated. The synapse is then seen as **enhanced**.
    - Now without the tail UC stimulus, a CS will still cause an enhanced response on the motor gill.


## 2. Models of Classical Conditioning
### 2.1 Introduction and Overview
The ability of animals to learn appropriate actions in response to particular stimuli is traditionally separated into **classical (Pavlovian) and instrumental (operant) conditioning**:
- **Classical conditioning**:
  - The reinforcers (rewards or punishments) are **delivered independently of any actions taken** by the animal
  - Similar to supervised learning in ML
- **Instrumental conditioning**:
  - Actions of the animal determine what reinforcement is provided
  - Similar to reinforcement learning in ML
  - Reinforcement learning is minimally supervised as animals are not told explicitly what actions to take in particular situations
  - They must work this out for themselves on the basis of the reinforcement they receive.
- **This course discusses only models for classical conditioning**
- $r$ denotes reward rather than firing rate
- $u$ denotes whether stimulus $s$ is present or not, in binary case, $u=1$ being stimulus is present, $u=0$ otherwise.
- $v$ denotes predicted reward (or total expected reward, see later)
- In classical conditioning there are 7 paradigms indicated below, the columns indicate the training procedures and results. We shall see the **secondary paradigm is unaccounted for** by the Rescorla-Wagner rule. $\bullet$ denotes absence of reward, $r'$ and $\bullet '$ denote expected reward and no reward respectively.

| Paradigm   | Pre-train         | Train                                               | Result                                                           |
|------------|-------------------|-----------------------------------------------------|------------------------------------------------------------------|
| Pavlovian  |                   | $s\rightarrow r$                                     | $s\rightarrow r'$                                                 |
| Extinction | $s\rightarrow r$   | $s\rightarrow \bullet$                                  | $s\rightarrow \bullet'$                                             |
| Partial    |                   | $s\rightarrow r \qquad s\rightarrow \bullet$             | $s\rightarrow  \alpha r' $                                       |
| Blocking   | $s_1\rightarrow r$ | $s_1 + s_2 \rightarrow r$                            | $s_1 \rightarrow r' \qquad s_2 \rightarrow \bullet'$                |
| Inhibitory |                   | $s_1 + s_2 \rightarrow \bullet \qquad s_1 \rightarrow r$ | $s_1 \rightarrow r' \qquad s_2 \rightarrow -r'$                  |
| Overshadow |                   | $s_1 + s_2 \rightarrow r$                            | $s_1 \rightarrow \alpha_1 r' \qquad s_2 \rightarrow\alpha_2  r'$ |
| **Secondary**  | $s_1\rightarrow r$ | $s_2 \rightarrow s_1$                                | $s_2 \rightarrow r'$                                              |
### 2.2 The Rescorla-Wagner Rule
- **Model Encapsulation:**
  - The Rescorla-Wagner rule is a version of the delta rule, provides a concise account of certain aspects of classical conditioning. **It is based on a simple linear prediction of the reward associated with a stimulus**
  - The expected reward, denoted $v$ is expressed as this stimulus variable multiplied by a weight $w$: $$v = wu$$
  - The value of the weight, is established by a learning rule designed to minimize the **expected square error** between actual reward and the prediction: $$w* = {\arg \min}_w  \langle (r-v)^2 \rangle$$
  - Through gradient descent, the trial by trial learning rule (Rescorla-Wagner rule) results in $$w \rightarrow w + \epsilon \delta u \qquad \text{with} \qquad \delta = r-v$$
  - Here $\epsilon$ is the learning rate, which can be interpreted as **the associability of stimulus with the reward**.
  - The crucial term in this rule is the prediction error $\delta$ which in later section can be interpreted as **the activity of dopaminergic cells in the ventral tegmental area (VTA)**

- **Acquisition and extinction**
  - If $\epsilon$ is small and $u=1$ on every trial (stimulus is always presented), then the rule ultimately makes $w$ fluctuates around $w = \langle r \rangle$, at which point average $\delta=0$. i.e. the animal has learnt.
  - Similarly, once stimulus is removed the weight should tend to 0
- **Partial reinforcement**
  - From table above, partial reinforcement states: $$\text{train:}\;\;s\rightarrow r \quad s\rightarrow \bullet \qquad \text{results:}\;\; s\rightarrow  \alpha r'$$
  - The Rescorla-Wagner rule also accounts for aspects of this phenomenon, in which a reward is associated with a stimulus only on a **random fraction of trials**.
  - This is exected from the delta rule, because the ultimate **steady-state average value of $w = \langle r \rangle$ is smaller than $r$ in this case**
- **Vector representation:**
  To account for experiments in which more than one stimulus is used (to explain **blocking, inhibition and overshadowing**), the Rescorla-Wagner rule is extended in vector form to include multiple stimuli:
  - Done by introducing a vector of binary variables $\bm{u}$, with each component representing the presence or absence of a given stimulus
  - Also a vector of weights $\bm{w}$, the prediction $v$ is formed by the dot product $$v = \bm{w}^T\bm{u}$$
  - Minimizing the prediction error is similar to the single stimulus case $$\bm{w} \rightarrow \bm{w} + \bm{\epsilon}\delta \bm{u} \quad \text{with} \quad \delta = r-v$$
- **Blocking**
  - From table above, **blocking** states: $$\text{pre-train} \quad s_1 \rightarrow r \quad \text{train:}\;\;s_1+s_2\rightarrow r \quad \text{results:}\;\; s_1\rightarrow  r' \;\; s_2 \rightarrow \bullet'$$
  - After an association has already developed for one stimulus, train with two stimuli in association with the reward. **The result is pre-association with the first stimulus with the reward blocks an association from forming between the second stimulus and the reward.**
  - This is because **training with first stimulus makes $w_1 = r$**, when the second stimulus is presented along with the first, its weight starts out being $w_2 = 0$ but since $v=r$, $\delta=0$ **hence $w_2$ stays 0**.
- **Inhibition**
  - From the table above, **Inhibition** states: $$\text{train:}\;\;s_1+s_2\rightarrow \bullet \;\;\;\; s_1 \rightarrow r\quad \text{results:}\;\; s_1\rightarrow  r' \;\; s_2 \rightarrow -r'$$
  - One stimulus is shown in conjunction with the reward in alternation with trails in which that stimulus and an additional stimulus are presented in the absence of reward. This results in **the second stimulus becomes a conditioned inhibitor, predicting the absence of the reward**
  - This is because **trials in which $s_1$ is associated with a reward result in a positive $w_1$**, over time in trials when both $s_1, s_2$ are presented, $w_1 + w_2 = 0$, hence $w_2$ must become negative
- **Overshadowing**
  - From the table above, **overshadowing** states:$$\text{train:}\;\;s_1+s_2\rightarrow r\quad \text{results:}\;\; s_1\rightarrow  \alpha_1 r' \;\;\; s_2\rightarrow  \alpha_2 r'$$
  - This can be encompassed by generalizing the delta rule so that **the two stimuli have different learning rates $\epsilon_1, \epsilon_2$**
  - Weight modification stops when $\langle \delta \rangle = 0$ at which point **the faster growing weight will be larger than the slower growing weight**
- **Secondary conditioning**
  - In classical conditioning we expect the following: $$\text{pre-train} \quad s_1 \rightarrow r \quad \text{train:}\;\;s_2\rightarrow s_1 \quad \text{results:}\;\; s_2\rightarrow  r'$$
  - i.e. **the association of one stimulus with a reward, followed by an association of a second stimulus with the first one**, causing the second stimulus to evoke expectation of a reward with which it has never been paired.
  - **This is not encapsulated by the Rescorla-Wagner model!**
  - Because the reward does not appear when the second stimulus is presented, the delta rule would cause $w_2$ to be negative! **In other words,** $s_2$ **BECOMES INHIBITORY**
  - Secondary conditioning raises the **important issue of keeping track of the time within a trial in which stimuli and rewards are present**, this motivates the foundation of Temporal Difference Learning

### 2.3 Predicting Future Reward: Temporal Difference Learning
We measure time within a trial using a discrete time variable $t$ which falls in range of $o \leq t \leq T$, the stimulus, prediction and the reward $u(t), v(t), r(t)$ are all expressed as functions of $t$.
- **Interpretation of $v(t)$**
  - Variable $v(t)$ should be interpreted as a **prediction of the TOTAL future reward expected from time $t$ onward to the end of trial**: $$v(t) = \left\langle \sum_{\tau=0}^{T-t} r(t+\tau)\right\rangle$$
  - This better matches to psychological and neurobiological data and suggests how animals might use their predictions to optimize behavior when rewards are **delayed**
- **Approximation of $v(t)$ i.e. learning rule**
  - Now the weights $w(t)$ is time dependent, the predicted total reward $v(t)$ takes form as a **convolution between the time varying stimulus and weight**: $$v(t) = \sum_{\tau = 0}^{t} w(\tau) u(t-\tau)$$
  - The weighting update rule is as follows: $$w(\tau) \rightarrow w(\tau) + \epsilon \delta(t)u(t-\tau)$$
  - Here $\delta(t)$ is the difference between **actual total reward from time $t$ and the predicted total reward**: $$\delta(t) = \sum_{\tau=t}^{T} r(\tau) - v(t)$$
  - However, in order to get $\delta(t)$, we need to evaluate $r(t)$ until the end of the trial $t=T$ which is not feasible (what is $r(t+1), r(t+2),...$?), a workaround is to say: $$\sum_{\tau=t}^Tr(\tau) \approx r(t) + v(t+1)$$
  - i.e. replace all the **unseen/unmeasured actual future reward with predicted total future reward** (we 'watered-down' our ground truth with our prediction)
  - This kind of watered down weight update is called the **temporal difference rule**:$$w(\tau) \rightarrow w(\tau) + \epsilon \delta(t)u(t-\tau) \quad \text{with} \quad \delta(t)=r(t) + v(t+1) - v(t) $$
  - Now the secondary conditioning can be accounted for using this model!
### 2.4 Dopamine and Predictions of Reward
- The prediction error $\delta$ plays an essential role in both the Rescorla-Wagner and temporal difference learning rules
- The neural signal that represents this quantity is (can) the activity **dopaminergic neurons** in the ventral tegmental area (VTA) in the midbrain.
![Capture](/assets/Capture_ub2r5nlj1.PNG)
- Figure above shows the activity of dopaminergic neurons in the VTA for a monkey performing reaction tasks. (A) activity of dopamine cell accumulated over 20 trials showing the spikes time-locked to a stimulus or the reward (right) at times marked 0
  - Stimulus is a sound, reward is the fruit juice if the monkey performs the task
  - Top row in (A) shows the monkey's dopamine level in early trial responds little to the sound (stimulus) but hugely to reward. In later trials (B) once monkey has learnt to associate sound to reward, it responds more strongly to stimulus and none to reward
  - In (B) a similar task is performed, here we see that when no reward is given, we see a inhibition of firing rate (bottom graph) compared with the top graph, further confirming the mode.

## 3. Prefrontal Cortex, Hippocampus and the Biology of Explicit Memory Storage
### 3.1 Mechanisms For Persistent Neural Activity
![1](/assets/1_6326tgqcj.PNG)
Neurons in the prefrontal cortex fire persistently during the delay period, contributing to the **neural representation of learning in working memory**. Two major mechanisms may contribute to this persistent neural activity: the **intrinsic properties of neuronal membranes and recurrent synaptic connectivity.**
* **Neuronal membrane property for persistent activity:**
  - In some cortical neurons a brief electrical stimulation can lead to persistent firing that lasts for seconds or even minutes after the end of the stimulus
  - The rate of firing can be a **graded function** of the intensity of the stimulation
  - This persistent firing is **not affected by blockers of fast excitatory and inhibitory synaptic transmission**
  - This maintained firing depends on the opening of a type of channel termed the **Ca2+ activated non-selective (CAN)** cation channel
    - The opening of these channels requires two simultaneous events
    - First, the muscarinic receptor signaling cascade must be stimulated by extracellular **acetylcholine**
    - There must be an **increase in intracellular Ca2+** normally generated by the opening of voltage-gated Ca2+ channels during the firing of a brief burst of action potentials
  - As the cytoplasmic Ca2+ level remains elevated for some time after the burst of action potentials, **the inward current through the CAN channels lead to a prolonged afterdepolarization (ADP) following the burst of action potentials.**
  - Positive feedback may occur if initial stimulation period is sufficiently intense
  - This is shown on the top left image
- **Recurrent synaptic connectivity**
  - Top right figure shows such mutual inhibition in a recurrent network
  - Persistent activity can be generated through mutual Inhibition
  - This example consists of two populations of neurons, group 1 and 2.
  - **Within each population the neurons are reciprocally connected by excitatory synapses**
  - However, each population mutually inhibits the other
  - In this manner an excitatory input to group 1 leads to the silencing of group 2, **the loss of inhibitory input from group 2 in turn enhances the firing of group 1.**
### 3.2 Long-Term Potentiation in the Hippocampus
* **Perforant Pathway** (indirect):
  ![2](/assets/2_wi30t935a.PNG)
  - Perceived sense - parahippocampal gyrus
  - parahippocampal gyrus - entorhinal cortex
  - entorhinal cortex - dentate gyrus - CA3 - CA1 - Subiculum - entorhinal cortex
  - The above chain fires through over and over to create memory (eventually travels to the cortex and is stored)
- The hippocampus recieves multimodal sensory and spatial information from nearby entorhinal cortex, **the major output of the hippocampus is through the pyramidal neurons in the CA1 region**
- **Information from the entorhinal cortex reaches CA1 neurons along two excitatory pathways, one direct, one indirect** picture above depicts the indirect pathway. Together, they form the preforant pathways.


## 4. Neuroelectronics
### 4.1 Electrical Properties of Neurons
- **Membrane potential**
  - By convention, the potential of extracellular fluid outside a neuron is defined to be 0
  - When a neuron is inactive, excess internal negative charge causes the potential inside the membrane to be negative
  - This potential **defines an equilibrium point where the flow of ions into the cell matches that out of the cell**
  - The potential can change if the balance of ion flow is changed through opening/closing of ion channels
  - **Neuronal membrane potentials vary over a range from -90 to +50mV**
  - To **estimate the scale** of typical membrane potentials, **equate the thermal energy of a mole of ions to the energy gained or lost when a mole of ions crosses a membrane with a potential difference $V_T$** $$V_T = \dfrac{k_BT}{q}$$
  - $V_T$ is between 24 and 27 mV for typical temperatures, this sets the overall scale for membrane potential across neuronal membranes, which range from about -3 to +2 times $V_T$
  - Note that $V_T$ defines a 'scale' and only accounts for thermal energy, to get the true membrane potential, we also need to account for concentration gradient across the membrane
- **Equilibrium and Reverse Potentials**
  - Electrical forces and diffusion are responsible for driving ions through channel pores
  - Negative membrane potentials attract positive ions into the neuron and repel negative ions
  - In addition, ions diffuse through channels because the ion concentrations differ inside and outside the neuron
  - These differences are maintained by the ion pumps within the cell membrane
  - **The concentrations of Na+ and Ca2+ are higher outside the cell than inside, K+ is more concentrated inside the neuron than outside**, this is due to the sodium potassium pump pumps three Na+ out per two K+ in
  - Consider a positive ion and a negative membrane potential, since the membrane potential opposes the ion to flow out of the cell, the ion can only leave the cell if its thermal energy suffices to overcome the energy barrier produced by the membrane potential. This turned out to be equal to $$e^{zV/V_t}$$ where $zq$ defines the charge of the ion, $z$ is the number of proton it has.
  - The biasing effect of the electrical potential can be overcome by an opposing concentration gradient. As the concentration of ions inside the cell [inside] is larger than concentration outside the cell [outside]. **We use letter $E$ to denote the particular potential which satisfies the balancing condition:** $$[outside] = [inside] e^{zR/V_T}$$
  - Hence we arrive at the **Nernst equation** $$E = \dfrac{V_T}{z}\ln\left(\dfrac{[outside]}{[inside]}\right)$$
  This defines the equilibrium potential for single ion conducting channels. For K+ channel, this typically falls in the range between -70 and -90mV. For Na+ this is 5-mV or higher, Ca2+ is even higher still (+150mV)
  - The Nernst equation applies when the channels allow only one type of ion to pass through them. Some channels are not so selective. **Goldman equation** can be used to estimate $E$ for such conductances. In this case, $E$ is **often called a reversal potential, rather than eq potential, because the direction of current flow through the channel switches as the membrane potential passes through $E$**
  - When V>E (V being membrane potential), **positive current flows outward**. When V<E, positive current flows inward. **Na+ and Ca2+ have positive E, they tend to depolarize a neuron**, **K+ conductance have negative E values, normally hyperpolarize a neuron, making it more negative** (look at the Nernst equation to see why)
- **Membrane Current**
  - Definition: the total current flowing across the membrane through all of its ion channels
  - **Defined positive when positive ions LEAVE the cell and negative when positive ions ENTER**
  ![1](/assets/1_j975f33zo.PNG)
  - To facilitate comparisons between neurons which differ in size, it is convenient to use the membrane current per unit area of cell membrane, denoted $i_m$
  - By indexing different types of channels with $i$, as shown earlier, the current carried by a set of channels with reversal potential $E_i$ vanishes when the membrane potential satisfies $V=E_i$, for many types of channels, the current decreases or increases linearly when the membrane potential deviate from this value. Hence $V-E_i$ is the driving force, and for each channel $i$ with conductance per unit area $g_i$ we have: $$i_m = \sum_i g_i (V-E_i)$$
  - Equation above can be lumped into one term for all of the **time=independent contributions to the membrane current** $$\bar{g_L}(V-E_L)$$ This is useful for different neuroelectric models later.
### 4.2 Single-Compartment and Integrate-and-Fire Models
- **Single-Compartment Models**
  - The equation for single-compartment models, like those of all neuron models, describe how charges flow into and out of a neuron and affect its membrane potential
  - Equation below provides the basic relationship which determines the membrane potential for a single-compartment model $$C_m \dfrac{dV}{dt} = \dfrac{dQ}{dt}$$
  This equation states that the rate of change of the membrane potential is proportional to the rate at which charge builds up inside the cell (which in turn is the total amount of current entering the neuron)
  - The relevant currents are those arising from all membrane and synaptic conductances plus, in an experimental setting, any injected current $I_e$, by normalizing using the surface area of the membrane $A$, we obtain the following equation: $$c_m \dfrac{dV}{dt} = -i_m + \dfrac{I_e}{A}$$
  - By convential, current enters the neuron through an electrode is positive-inward, whereas membrane current is defined as positive outward (see earlier picture)
- **Integrate-and-Fire Models**
  - A neudon will typically fire an action potential when its membrane potential reaches a threshold value of about -55 to -50mV
  - We can greatly simplify the neuron model if we do not account for biophysical mechanisms responsible for action potentials (i.e. voltage dependent conductances). Integrate-and-fire models do this through stipulation that an action potential occurs whenever the membrane potential of the model neuron reaches a threshold value of $V_{th}$. After the action potential, the potential is reset to a value below the threshold potential.
  - In the simplest version, all active membrane conductances are ignored, including, for the moment, synaptic inputs, and the entire membrane conductance is modelled as a single passive leakage term, $i_m = \bar{g_L} (V-E_L)$
  - With these approximations, the model neuron behaves like an electric circuit consisting of a resistor and a capacitor in parallel, and the membrane potential is determined by: $$c_m \dfrac{dV}{dt} = -\bar{g_L} (V-E_L) + \dfrac{I_e}{A}$$
  - Inspecting the equation above, we can see that an equivalent circuit can be represented with figure below, with current injected into the circuit (not shown)
   ![1](/assets/1_0mh901wi2.PNG)
  - Multiply the equation above both sides by specific membrane resistance $r_m$ we obtain: $$\tau_m \dfrac{dV}{dt} = E_L-V + R_mI_e$$ We see that when no current is injected, the membrane potential relaxes exponentially with the time constant $\tau_m$ to $V=E_L$. Thus $E_L$ is the reseing potential of the model cell.
  - The integrate-and-fire model (right figure below) fails to demonstrate spike-rate adaptation feature in many neurons such as cortical pyramidal cells. It is the phenomenon that the interspike intervals lengthen over time when a constant current is injected into the cell, before setting to a steady state value (left figure below).
  ![1](/assets/1_buu9so33c.PNG)

### 4.3 Voltage Dependent Conductances
- **Open probability**
  - The conductance per unit area of membrane due to a set of ion channels of type $i$ by $g_i$. The value of $g_i$ at any given time is determined by $$g_i = \bar{g_i}P_i$$ where the first term $\bar{g_i}$ denotes the maximal conductance (conductance of an open channel times the density of channels in the membrane), the second term denotes the fraction of channels that are open at that time.
  ![1](/assets/1_oax0uh5vy.PNG)

- **Persistent Conductances**
  - Left figure shows a cartoon model of K+ channel conductance, it is a model for persistent conductance, which acts as if it had a single type of gate. Opening of the gate is called activation, closing is called deactivation
  - Opening of the gate that describes a persistent conductance may involve a number of conformational changes. For example, the K+ conductance is constructed from four identical subunits, and it appears that **all four must undergo a structural change for the channel to open**, if $k$ is independent and denotes the number of subunits for the ion channel, then for a channel to open $P_K$ can be written as $$P_K = n^k$$ where $n$ is the probability that any one of the $k$ independent gating events has occurred, can also be viewed as the proportion (0 to 1) of gates that are opened.
  - We describe the transition of each subunit gate by a simple kinetic scheme in which the gating transition from closed to opened occurs at a voltage dependent rate $\alpha_n(V)$, the reverse transition, open to close, occurs at rate $\beta_n(V)$, by using these, a differential equation can be set up for us to investigate the voltage response of these gates: $$\dfrac{dn}{dt} = \alpha_n(V)(1-n)- \beta_n(V)n$$ i.e. change in proportion of the gates that are opened = opening rate times the proportion of closed gates minus the closing rate times the proportion of gates that are open
  - Multiply both sides by $\tau_n(V) = 1/(\alpha_n(V) + \beta_n(V))$ we obtain $$\tau_n(V)\dfrac{dn}{dt} = n_\infty (V) -n$$ where $$n_\infty(V) = \dfrac{\alpha_n(V)}{\alpha_n(V) + \beta_n(V)}$$
  - Hence for a given $V$ we see that $n$ approaches the limiting value $n_\infty(V)$ exponentially with time constant $\tau_n(V)$ **Note the smaller the time constant, the more rapid the convergence to steady state**
  - Here we quote without explainations that opening rate $\alpha_n$ grows exponentially w.r.t voltage, $\beta_n$ has a inverse correlation w.r.t V. Therefore we have the following graphs:
  ![1](/assets/1_dm81bap70.PNG)
  - These opening and closing rates are used to define the Hodgkin-Huxley model (described later)
- **Transient Conductances**
  -  Some channels such as the Na+ channel openly open transiently when the membrane potential is depolarized because they are gated **by two processes with opposite voltage dependences**, this is shown in the right figure at the beginning of this section.
  - This two gated process has a swinging gate which behaves exactly like the one in persistent conductances, denoted as $m^k$, where $m$ is an activation variable similar to $n$ and $k$ is an integer (hyperparameter but very similar to the number of subunits which make up the channel).
  - The ball in the right figure acts as the second gate, the probability that **the ball does not block the channel pore is written as $h$ and is called the inactivation variable**
  - **DEPOLARIZATION causes $m$ to INCREASE and $h$ to DECREASE, HYPERPOLARIZATION causes $m$ to decrease and $h$ to INCREASE**
  - Assuming these two gates act independently, thr probability that a Na+ channel is open is denoted as $$P_{Na} = m^k h$$
  - Similar as finding out the steady state response for $n_\infty$, experiments are conducted to find the opening rates and closing rates $\alpha_m, \beta_m, \alpha_h, \beta_h$ for gates $m$ and $h$ respectively. These are then used to find the voltage responses for these gates
- **Symmary**
  - Plotting the steady state voltage responses for gates $n, m, h$ and their respective time constant (rate of convergence toward steady state), we can summarize them with the graphs below:  
  ![1](/assets/1_g83a9l4az.PNG)
  - These are pretty OP graphs, interpreting them can be howerver difficult. This states:
    - For K+ channels which are governed by $n$, large negative voltage (-80mV) corresponds to most gates closed, gates open quickly then saturates as voltage becomes less negative (towards all being opened at 0mV)
    - There however, exists a voltage around -50mV where the rate of opening is SLOWEST, then as we increase voltage, the rate increases (pretty sharply)
    - Similar arguments apply to both $m$ and $h$
    - Note that $h$, the inactivating gate for Na+ has LOWEST rate of closing at around -50mV also, and again sharply INCREASES as voltage becomes less negative.
    - In turns of 'sluggishness' we can rank the Na+ activating gate to be the fastest, followed by K+ gate, finally the Na+ deactivating gate
  - These graphs provide the foundation for the voltage responses in Hodgkin-Huxley Model

### 4.4 The Hodgkin-Huxley Model
- The Hodgkin_Huxley model for the generation of the action potential, in its single-compartment form is constructed by the membrane current equation described in section 4.2 as a sum of a **leakage current, a delayed-rectified K+ current and a transient Na+ current**: $$i_m = \bar{g_L}(V-E_L) + \bar{g_K}n^4(V-E_K)+\bar{g_{Na}}m^3h(V-E_{Na})$$
- The temporal evolution of the dynamic variables of the Hodgkin-Huxley model during a single action potential is shown in figure below, for ease of explaination, the same figure showing gates responses are reproduced also.
![1](/assets/1_jbqxb88l8.PNG)
![1](/assets/1_g83a9l4az.PNG)

- The initial rise of the membrane potential, prior to the action potential is due to the injection of a positive current starting at t = 5ms
- When the current drives the membrane potential up to about -50mV, the $m$ variable that describes the activation of the Na+ conductance suddenly jumps from 0 to a value near 1. Initially, the $h$ variable, expressing the degree of inactivation of the Na+ conductance is around 0.6
- Thus for a brief period both $m$ and $h$ are significantly different from 0, this causes a large influx of Na+ ions, producing the **sharp downward spike of inward current**
- The inward current causes the membrane potential to rise rapidly to around 50mV. This rapid increase in both $V$ and $m$ is due to positive feedback
- Depolarization of the membrane causes the Na+ conductance to inactivate by driving h towards 0. This shuts off the Na+ current
- In addition, the rise in V activates K+ conductance by driving $n$ towards 1. This increases the K+ current, which drives the membrane potential back down to negative value.
